<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SlotLab Unified V4 - Symbol Strip</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0a0a0c 0%, #1a1a20 100%);
            color: #e0e0e0;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: rgba(30, 30, 40, 0.8);
            border-radius: 12px;
            margin-bottom: 20px;
            border: 1px solid rgba(74, 158, 255, 0.2);
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            background: linear-gradient(135deg, #4a9eff, #40ff90);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .mode-toggle {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .mode-btn {
            padding: 10px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .mode-btn.play {
            background: linear-gradient(135deg, #40ff90, #30cc70);
            color: #000;
        }

        .mode-btn.edit {
            background: rgba(255, 144, 64, 0.2);
            color: #ff9040;
            border: 1px solid #ff9040;
        }

        .mode-btn.active {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(74, 158, 255, 0.5);
        }

        .mode-btn.play.active {
            box-shadow: 0 0 20px rgba(64, 255, 144, 0.5);
        }

        .mode-btn.edit.active {
            background: #ff9040;
            color: #000;
            box-shadow: 0 0 20px rgba(255, 144, 64, 0.5);
        }

        /* State Tabs */
        .state-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .state-tab {
            padding: 12px 24px;
            background: rgba(40, 40, 50, 0.8);
            border: 1px solid rgba(74, 158, 255, 0.3);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .state-tab:hover {
            background: rgba(74, 158, 255, 0.2);
        }

        .state-tab.active {
            background: linear-gradient(135deg, #4a9eff, #3080dd);
            color: #fff;
            border-color: transparent;
        }

        /* Main Content */
        .main-content {
            display: flex;
            gap: 20px;
        }

        /* Symbol Strip */
        .symbol-strip {
            width: 280px;
            flex-shrink: 0;
            background: rgba(25, 25, 35, 0.9);
            border-radius: 12px;
            border: 1px solid rgba(74, 158, 255, 0.2);
            padding: 15px;
            max-height: 600px;
            overflow-y: auto;
        }

        .symbol-strip-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .symbol-strip-title {
            font-size: 14px;
            font-weight: 600;
            color: #4a9eff;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .add-symbol-btn {
            padding: 6px 12px;
            background: rgba(64, 255, 144, 0.2);
            color: #40ff90;
            border: 1px solid #40ff90;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .add-symbol-btn:hover {
            background: #40ff90;
            color: #000;
        }

        .symbol-item {
            background: rgba(40, 40, 55, 0.8);
            border-radius: 10px;
            margin-bottom: 10px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .symbol-header {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .symbol-header:hover {
            background: rgba(74, 158, 255, 0.1);
        }

        .symbol-icon {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
        }

        .symbol-name {
            flex: 1;
            font-weight: 600;
        }

        .symbol-badge {
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
        }

        .badge-special { background: rgba(255, 64, 96, 0.3); color: #ff4060; }
        .badge-high { background: rgba(255, 200, 64, 0.3); color: #ffc840; }
        .badge-low { background: rgba(100, 150, 200, 0.3); color: #6496c8; }

        .symbol-expand {
            font-size: 12px;
            color: #888;
            transition: transform 0.3s ease;
        }

        .symbol-item.expanded .symbol-expand {
            transform: rotate(180deg);
        }

        .symbol-contexts {
            display: none;
            padding: 0 12px 12px;
        }

        .symbol-item.expanded .symbol-contexts {
            display: block;
        }

        .context-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            margin: 4px 0;
            background: rgba(30, 30, 45, 0.8);
            border-radius: 8px;
            border: 2px dashed transparent;
            transition: all 0.3s ease;
        }

        .context-item.drop-target {
            border-color: rgba(255, 144, 64, 0.5);
        }

        .context-item.drop-target:hover {
            border-color: #ff9040;
            background: rgba(255, 144, 64, 0.1);
        }

        .context-item.drop-target.drag-over {
            border-color: #40ff90;
            background: rgba(64, 255, 144, 0.2);
            transform: scale(1.02);
        }

        .context-item.has-audio {
            border-color: #40ff90;
            border-style: solid;
        }

        .context-name {
            flex: 1;
            font-size: 13px;
            color: #aaa;
        }

        .context-status {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
        }

        .context-status.empty {
            border: 2px dashed #555;
        }

        .context-status.filled {
            background: #40ff90;
            color: #000;
        }

        /* Scatter quantity variants */
        .scatter-quantities {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 4px;
            margin-top: 8px;
        }

        .quantity-item {
            padding: 8px;
            background: rgba(30, 30, 45, 0.8);
            border-radius: 6px;
            text-align: center;
            font-size: 11px;
            border: 2px dashed transparent;
        }

        .quantity-item.drop-target {
            border-color: rgba(255, 144, 64, 0.5);
        }

        .quantity-item.has-audio {
            border-color: #40ff90;
            border-style: solid;
        }

        .quantity-label {
            font-weight: 600;
            color: #ffc840;
        }

        /* Per-reel toggle */
        .per-reel-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 12px;
            margin-top: 8px;
            background: rgba(20, 20, 30, 0.8);
            border-radius: 8px;
            font-size: 12px;
        }

        .toggle-switch {
            width: 36px;
            height: 20px;
            background: #333;
            border-radius: 10px;
            position: relative;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .toggle-switch.active {
            background: #4a9eff;
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 16px;
            height: 16px;
            background: #fff;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: transform 0.3s ease;
        }

        .toggle-switch.active::after {
            transform: translateX(16px);
        }

        /* Slot Preview */
        .slot-preview-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .slot-machine {
            background: linear-gradient(180deg, #1a1a25 0%, #0d0d12 100%);
            border-radius: 20px;
            padding: 30px;
            border: 2px solid rgba(74, 158, 255, 0.3);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        /* Reels */
        .reels-container {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 25px;
        }

        .reel {
            width: 100px;
            height: 260px;
            background: linear-gradient(180deg, #0a0a10 0%, #15151f 50%, #0a0a10 100%);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .reel.drop-target {
            border: 2px dashed #ff9040;
        }

        .reel.drop-target:hover {
            border-color: #40ff90;
            box-shadow: 0 0 20px rgba(64, 255, 144, 0.3);
        }

        .reel-strip {
            position: absolute;
            width: 100%;
            transition: transform 0.1s ease-out;
        }

        .reel.spinning .reel-strip {
            animation: spin 0.15s linear infinite;
        }

        @keyframes spin {
            0% { transform: translateY(0); }
            100% { transform: translateY(-80px); }
        }

        .symbol {
            width: 100%;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 42px;
            background: linear-gradient(180deg, rgba(255,255,255,0.05) 0%, transparent 100%);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .reel-label {
            position: absolute;
            bottom: 5px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            color: #666;
            background: rgba(0, 0, 0, 0.5);
            padding: 2px 8px;
            border-radius: 4px;
        }

        /* Win Display */
        .win-display {
            text-align: center;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .win-amount {
            font-size: 36px;
            font-weight: 700;
            background: linear-gradient(135deg, #ffc840, #ff9040);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .win-label {
            font-size: 12px;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        /* Controls */
        .slot-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .spin-btn {
            padding: 18px 60px;
            font-size: 18px;
            font-weight: 700;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .spin-btn.primary {
            background: linear-gradient(135deg, #40ff90, #30cc70);
            color: #000;
        }

        .spin-btn.primary:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(64, 255, 144, 0.4);
        }

        .spin-btn.drop-target {
            border: 3px dashed #ff9040;
        }

        .control-btn {
            padding: 15px 25px;
            background: rgba(40, 40, 55, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            background: rgba(74, 158, 255, 0.3);
            border-color: #4a9eff;
        }

        .control-btn.drop-target {
            border: 2px dashed #ff9040;
        }

        /* Feature-specific screens */
        .feature-screen {
            display: none;
        }

        .feature-screen.active {
            display: block;
        }

        /* Free Spins */
        .fs-counter {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 20px;
        }

        .fs-stat {
            text-align: center;
            padding: 15px 25px;
            background: rgba(74, 158, 255, 0.2);
            border-radius: 12px;
            border: 1px solid rgba(74, 158, 255, 0.3);
        }

        .fs-stat.drop-target {
            border: 2px dashed #ff9040;
        }

        .fs-value {
            font-size: 32px;
            font-weight: 700;
            color: #4a9eff;
        }

        .fs-label {
            font-size: 11px;
            color: #888;
            text-transform: uppercase;
        }

        /* Hold & Win Grid */
        .hold-win-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        .hw-cell {
            aspect-ratio: 1;
            background: rgba(30, 30, 45, 0.8);
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: 2px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .hw-cell.drop-target {
            border: 2px dashed #ff9040;
        }

        .hw-cell.locked {
            background: linear-gradient(135deg, #4a9eff, #3070cc);
            border-color: #4a9eff;
        }

        .hw-cell.locked .hw-value {
            color: #fff;
        }

        .hw-value {
            font-size: 18px;
            font-weight: 700;
            color: #666;
        }

        /* Bonus Pick Game */
        .bonus-picks {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .pick-item {
            aspect-ratio: 1;
            background: linear-gradient(135deg, #2a2a3a, #1a1a28);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid rgba(255, 200, 64, 0.3);
        }

        .pick-item.drop-target {
            border: 3px dashed #ff9040;
        }

        .pick-item:hover {
            transform: scale(1.05);
            border-color: #ffc840;
            box-shadow: 0 10px 30px rgba(255, 200, 64, 0.3);
        }

        /* Jackpot Display */
        .jackpot-display {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .jackpot-tier {
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .jackpot-tier.drop-target {
            border: 2px dashed #ff9040 !important;
        }

        .jackpot-tier.mini { background: linear-gradient(135deg, #4a5568, #2d3748); }
        .jackpot-tier.minor { background: linear-gradient(135deg, #48bb78, #2f855a); }
        .jackpot-tier.major { background: linear-gradient(135deg, #4299e1, #2b6cb0); }
        .jackpot-tier.grand { background: linear-gradient(135deg, #f6ad55, #dd6b20); }

        .jp-label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 2px;
            opacity: 0.8;
        }

        .jp-value {
            font-size: 24px;
            font-weight: 700;
            margin-top: 5px;
        }

        /* Transition Zones */
        .transition-zones {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 20px;
            padding: 15px;
            background: rgba(20, 20, 30, 0.8);
            border-radius: 12px;
        }

        .transition-zone {
            padding: 10px 18px;
            background: rgba(40, 40, 55, 0.8);
            border: 2px dashed rgba(255, 144, 64, 0.3);
            border-radius: 8px;
            font-size: 12px;
            color: #aaa;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .transition-zone:hover {
            border-color: #ff9040;
            color: #fff;
        }

        .transition-zone.has-audio {
            border-color: #40ff90;
            border-style: solid;
            color: #40ff90;
        }

        .transition-zone.drag-over {
            border-color: #40ff90;
            background: rgba(64, 255, 144, 0.2);
        }

        /* Timeline */
        .timeline {
            background: rgba(25, 25, 35, 0.9);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(74, 158, 255, 0.2);
        }

        .timeline-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .timeline-title {
            font-size: 14px;
            font-weight: 600;
            color: #4a9eff;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .timeline-events {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .timeline-event {
            padding: 10px 16px;
            background: rgba(40, 40, 55, 0.8);
            border-radius: 8px;
            border-left: 3px solid;
            font-size: 12px;
        }

        .event-spin { border-color: #4a9eff; }
        .event-symbol { border-color: #ffc840; }
        .event-win { border-color: #40ff90; }
        .event-feature { border-color: #ff4060; }

        .event-name {
            font-weight: 600;
            margin-bottom: 3px;
        }

        .event-audio {
            font-size: 10px;
            color: #888;
        }

        /* Audio Browser */
        .audio-browser {
            position: fixed;
            right: 20px;
            top: 120px;
            width: 220px;
            background: rgba(25, 25, 35, 0.95);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid rgba(74, 158, 255, 0.3);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            z-index: 100;
            display: none;
        }

        .audio-browser.visible {
            display: block;
        }

        .browser-title {
            font-size: 12px;
            font-weight: 600;
            color: #4a9eff;
            margin-bottom: 12px;
            text-transform: uppercase;
        }

        .audio-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: rgba(40, 40, 55, 0.8);
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: grab;
            transition: all 0.2s ease;
        }

        .audio-item:hover {
            background: rgba(74, 158, 255, 0.2);
        }

        .audio-item:active {
            cursor: grabbing;
        }

        .audio-icon {
            font-size: 18px;
        }

        .audio-name {
            font-size: 12px;
            flex: 1;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: rgba(64, 255, 144, 0.95);
            color: #000;
            padding: 15px 30px;
            border-radius: 10px;
            font-weight: 600;
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        /* Instructions */
        .instructions {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(30, 30, 40, 0.95);
            padding: 15px 20px;
            border-radius: 10px;
            font-size: 12px;
            color: #888;
            border: 1px solid rgba(74, 158, 255, 0.2);
        }

        .instructions strong {
            color: #4a9eff;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(74, 158, 255, 0.5);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(74, 158, 255, 0.7);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">SlotLab Studio</div>
            <div class="mode-toggle">
                <button class="mode-btn play active" onclick="setMode('play')">‚ñ∂ PLAY</button>
                <button class="mode-btn edit" onclick="setMode('edit')">‚úèÔ∏è EDIT</button>
            </div>
        </div>

        <div class="state-tabs">
            <div class="state-tab active" onclick="setState('base')">üé∞ Base Game</div>
            <div class="state-tab" onclick="setState('freespins')">‚≠ê Free Spins</div>
            <div class="state-tab" onclick="setState('holdwin')">üîí Hold & Win</div>
            <div class="state-tab" onclick="setState('bonus')">üéÅ Bonus</div>
            <div class="state-tab" onclick="setState('jackpot')">üíé Jackpot</div>
        </div>

        <div class="main-content">
            <!-- Symbol Strip -->
            <div class="symbol-strip" id="symbolStrip">
                <div class="symbol-strip-header">
                    <span class="symbol-strip-title">Symbols</span>
                    <button class="add-symbol-btn" onclick="addSymbol()">+ Add</button>
                </div>

                <!-- Wild -->
                <div class="symbol-item expanded" onclick="toggleSymbol(this)">
                    <div class="symbol-header">
                        <div class="symbol-icon">üÉè</div>
                        <div class="symbol-name">WILD</div>
                        <span class="symbol-badge badge-special">SPECIAL</span>
                        <span class="symbol-expand">‚ñº</span>
                    </div>
                    <div class="symbol-contexts">
                        <div class="context-item drop-target" data-target="wild_land" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'WILD_LAND')">
                            <span class="context-name">Land</span>
                            <div class="context-status empty"></div>
                        </div>
                        <div class="context-item drop-target" data-target="wild_win" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'WILD_WIN')">
                            <span class="context-name">In Win Line</span>
                            <div class="context-status empty"></div>
                        </div>
                        <div class="context-item drop-target" data-target="wild_expand" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'WILD_EXPAND')">
                            <span class="context-name">Expand</span>
                            <div class="context-status empty"></div>
                        </div>
                        <div class="context-item drop-target" data-target="wild_stack" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'WILD_STACK')">
                            <span class="context-name">Stack Complete</span>
                            <div class="context-status empty"></div>
                        </div>
                        <div class="per-reel-toggle">
                            <div class="toggle-switch active" onclick="event.stopPropagation(); togglePerReel(this)"></div>
                            <span>Per-Reel Pan (auto)</span>
                        </div>
                    </div>
                </div>

                <!-- Scatter -->
                <div class="symbol-item" onclick="toggleSymbol(this)">
                    <div class="symbol-header">
                        <div class="symbol-icon">‚≠ê</div>
                        <div class="symbol-name">SCATTER</div>
                        <span class="symbol-badge badge-special">SPECIAL</span>
                        <span class="symbol-expand">‚ñº</span>
                    </div>
                    <div class="symbol-contexts">
                        <div class="scatter-quantities">
                            <div class="quantity-item drop-target" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'SCATTER_LAND_1')">
                                <div class="quantity-label">1x</div>
                            </div>
                            <div class="quantity-item drop-target" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'SCATTER_LAND_2')">
                                <div class="quantity-label">2x</div>
                            </div>
                            <div class="quantity-item drop-target has-audio" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'SCATTER_LAND_3')">
                                <div class="quantity-label">3x</div>
                            </div>
                            <div class="quantity-item drop-target" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'SCATTER_LAND_4')">
                                <div class="quantity-label">4x</div>
                            </div>
                            <div class="quantity-item drop-target" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'SCATTER_LAND_5')">
                                <div class="quantity-label">5x</div>
                            </div>
                        </div>
                        <div class="context-item drop-target has-audio" data-target="scatter_trigger" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'SCATTER_TRIGGER')">
                            <span class="context-name">Trigger Feature</span>
                            <div class="context-status filled">‚úì</div>
                        </div>
                        <div class="per-reel-toggle">
                            <div class="toggle-switch active" onclick="event.stopPropagation(); togglePerReel(this)"></div>
                            <span>Per-Reel Pan (auto)</span>
                        </div>
                    </div>
                </div>

                <!-- High Pay 1 -->
                <div class="symbol-item" onclick="toggleSymbol(this)">
                    <div class="symbol-header">
                        <div class="symbol-icon">üëë</div>
                        <div class="symbol-name">HIGH PAY 1</div>
                        <span class="symbol-badge badge-high">HIGH</span>
                        <span class="symbol-expand">‚ñº</span>
                    </div>
                    <div class="symbol-contexts">
                        <div class="context-item drop-target" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'HIGH1_LAND')">
                            <span class="context-name">Land</span>
                            <div class="context-status empty"></div>
                        </div>
                        <div class="context-item drop-target" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'HIGH1_WIN')">
                            <span class="context-name">In Win Line</span>
                            <div class="context-status empty"></div>
                        </div>
                    </div>
                </div>

                <!-- High Pay 2 -->
                <div class="symbol-item" onclick="toggleSymbol(this)">
                    <div class="symbol-header">
                        <div class="symbol-icon">üíé</div>
                        <div class="symbol-name">HIGH PAY 2</div>
                        <span class="symbol-badge badge-high">HIGH</span>
                        <span class="symbol-expand">‚ñº</span>
                    </div>
                    <div class="symbol-contexts">
                        <div class="context-item drop-target" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'HIGH2_LAND')">
                            <span class="context-name">Land</span>
                            <div class="context-status empty"></div>
                        </div>
                        <div class="context-item drop-target" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'HIGH2_WIN')">
                            <span class="context-name">In Win Line</span>
                            <div class="context-status empty"></div>
                        </div>
                    </div>
                </div>

                <!-- Low Pay Symbols -->
                <div class="symbol-item" onclick="toggleSymbol(this)">
                    <div class="symbol-header">
                        <div class="symbol-icon">üÖ∞Ô∏è</div>
                        <div class="symbol-name">LOW PAY (A)</div>
                        <span class="symbol-badge badge-low">LOW</span>
                        <span class="symbol-expand">‚ñº</span>
                    </div>
                    <div class="symbol-contexts">
                        <div class="context-item drop-target" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'LOWA_LAND')">
                            <span class="context-name">Land</span>
                            <div class="context-status empty"></div>
                        </div>
                        <div class="context-item drop-target" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'LOWA_WIN')">
                            <span class="context-name">In Win Line</span>
                            <div class="context-status empty"></div>
                        </div>
                    </div>
                </div>

                <div class="symbol-item" onclick="toggleSymbol(this)">
                    <div class="symbol-header">
                        <div class="symbol-icon">üÖ∫</div>
                        <div class="symbol-name">LOW PAY (K)</div>
                        <span class="symbol-badge badge-low">LOW</span>
                        <span class="symbol-expand">‚ñº</span>
                    </div>
                    <div class="symbol-contexts">
                        <div class="context-item drop-target" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'LOWK_LAND')">
                            <span class="context-name">Land</span>
                            <div class="context-status empty"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slot Preview -->
            <div class="slot-preview-container">
                <div class="slot-machine">
                    <!-- BASE GAME -->
                    <div class="feature-screen active" id="screen-base">
                        <div class="reels-container">
                            <div class="reel" id="reel0" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'REEL_STOP_0')">
                                <div class="reel-strip" id="strip0">
                                    <div class="symbol">üÖ∞Ô∏è</div>
                                    <div class="symbol">üëë</div>
                                    <div class="symbol">üíé</div>
                                    <div class="symbol">‚≠ê</div>
                                    <div class="symbol">üÖ∫</div>
                                </div>
                                <div class="reel-label">REEL 1</div>
                            </div>
                            <div class="reel" id="reel1" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'REEL_STOP_1')">
                                <div class="reel-strip" id="strip1">
                                    <div class="symbol">üÉè</div>
                                    <div class="symbol">üÖ∞Ô∏è</div>
                                    <div class="symbol">üÖ∫</div>
                                    <div class="symbol">üëë</div>
                                    <div class="symbol">üíé</div>
                                </div>
                                <div class="reel-label">REEL 2</div>
                            </div>
                            <div class="reel" id="reel2" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'REEL_STOP_2')">
                                <div class="reel-strip" id="strip2">
                                    <div class="symbol">üíé</div>
                                    <div class="symbol">‚≠ê</div>
                                    <div class="symbol">üÉè</div>
                                    <div class="symbol">üÖ∞Ô∏è</div>
                                    <div class="symbol">üëë</div>
                                </div>
                                <div class="reel-label">REEL 3</div>
                            </div>
                            <div class="reel" id="reel3" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'REEL_STOP_3')">
                                <div class="reel-strip" id="strip3">
                                    <div class="symbol">üëë</div>
                                    <div class="symbol">üÖ∫</div>
                                    <div class="symbol">‚≠ê</div>
                                    <div class="symbol">üíé</div>
                                    <div class="symbol">üÉè</div>
                                </div>
                                <div class="reel-label">REEL 4</div>
                            </div>
                            <div class="reel" id="reel4" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'REEL_STOP_4')">
                                <div class="reel-strip" id="strip4">
                                    <div class="symbol">‚≠ê</div>
                                    <div class="symbol">üÖ∞Ô∏è</div>
                                    <div class="symbol">üëë</div>
                                    <div class="symbol">üÖ∫</div>
                                    <div class="symbol">üíé</div>
                                </div>
                                <div class="reel-label">REEL 5</div>
                            </div>
                        </div>
                        <div class="win-display" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'WIN_PRESENT')">
                            <div class="win-label">WIN</div>
                            <div class="win-amount" id="winAmount">$0.00</div>
                        </div>
                        <div class="slot-controls">
                            <button class="control-btn" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'AUTOPLAY_START')">AUTO</button>
                            <button class="spin-btn primary" id="spinBtn" onclick="spin()" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'SPIN_START')">SPIN</button>
                            <button class="control-btn" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'MAX_BET_SELECT')">MAX BET</button>
                        </div>
                    </div>

                    <!-- FREE SPINS -->
                    <div class="feature-screen" id="screen-freespins">
                        <div class="fs-counter">
                            <div class="fs-stat" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'FS_SPIN_COUNT')">
                                <div class="fs-value">8</div>
                                <div class="fs-label">Spins Left</div>
                            </div>
                            <div class="fs-stat" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'FS_MULTIPLIER_CHANGE')">
                                <div class="fs-value">3x</div>
                                <div class="fs-label">Multiplier</div>
                            </div>
                            <div class="fs-stat" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'FS_TOTAL_WIN')">
                                <div class="fs-value">$245.00</div>
                                <div class="fs-label">Total Win</div>
                            </div>
                        </div>
                        <div class="reels-container">
                            <!-- Same reels, different context -->
                            <div class="reel" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'FS_REEL_STOP_0')"><div class="reel-strip"><div class="symbol">‚≠ê</div><div class="symbol">üÉè</div><div class="symbol">üëë</div></div><div class="reel-label">R1</div></div>
                            <div class="reel" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'FS_REEL_STOP_1')"><div class="reel-strip"><div class="symbol">üÉè</div><div class="symbol">‚≠ê</div><div class="symbol">üíé</div></div><div class="reel-label">R2</div></div>
                            <div class="reel" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'FS_REEL_STOP_2')"><div class="reel-strip"><div class="symbol">üëë</div><div class="symbol">üÉè</div><div class="symbol">‚≠ê</div></div><div class="reel-label">R3</div></div>
                            <div class="reel" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'FS_REEL_STOP_3')"><div class="reel-strip"><div class="symbol">üíé</div><div class="symbol">üëë</div><div class="symbol">üÉè</div></div><div class="reel-label">R4</div></div>
                            <div class="reel" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'FS_REEL_STOP_4')"><div class="reel-strip"><div class="symbol">üÉè</div><div class="symbol">üíé</div><div class="symbol">üëë</div></div><div class="reel-label">R5</div></div>
                        </div>
                        <div class="slot-controls">
                            <button class="spin-btn primary" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'FS_SPIN_START')">FREE SPIN</button>
                        </div>
                    </div>

                    <!-- HOLD & WIN -->
                    <div class="feature-screen" id="screen-holdwin">
                        <div class="fs-counter">
                            <div class="fs-stat" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'HW_RESPIN_COUNT')">
                                <div class="fs-value">3</div>
                                <div class="fs-label">Respins</div>
                            </div>
                        </div>
                        <div class="hold-win-grid">
                            <div class="hw-cell locked" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'HW_SYMBOL_LOCK')"><div class="hw-value">5x</div></div>
                            <div class="hw-cell" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'HW_CELL_EMPTY')"></div>
                            <div class="hw-cell locked"><div class="hw-value">2x</div></div>
                            <div class="hw-cell" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'HW_CELL_EMPTY')"></div>
                            <div class="hw-cell locked"><div class="hw-value">MINI</div></div>
                            <div class="hw-cell" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'HW_CELL_EMPTY')"></div>
                            <div class="hw-cell locked"><div class="hw-value">3x</div></div>
                            <div class="hw-cell" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'HW_CELL_EMPTY')"></div>
                            <div class="hw-cell" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'HW_CELL_EMPTY')"></div>
                            <div class="hw-cell locked"><div class="hw-value">10x</div></div>
                            <div class="hw-cell" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'HW_CELL_EMPTY')"></div>
                            <div class="hw-cell locked"><div class="hw-value">1x</div></div>
                            <div class="hw-cell" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'HW_CELL_EMPTY')"></div>
                            <div class="hw-cell" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'HW_CELL_EMPTY')"></div>
                            <div class="hw-cell locked"><div class="hw-value">MAJOR</div></div>
                        </div>
                        <div class="slot-controls">
                            <button class="spin-btn primary" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'HW_RESPIN')">RESPIN</button>
                        </div>
                    </div>

                    <!-- BONUS -->
                    <div class="feature-screen" id="screen-bonus">
                        <h3 style="text-align: center; margin-bottom: 20px; color: #ffc840;">üéÅ Pick Your Prize!</h3>
                        <div class="bonus-picks">
                            <div class="pick-item" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'BONUS_PICK_REVEAL')">üéÅ</div>
                            <div class="pick-item" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'BONUS_PICK_REVEAL')">üéÅ</div>
                            <div class="pick-item" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'BONUS_PICK_REVEAL')">üéÅ</div>
                            <div class="pick-item" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'BONUS_PICK_REVEAL')">üéÅ</div>
                            <div class="pick-item" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'BONUS_PICK_REVEAL')">üéÅ</div>
                            <div class="pick-item" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'BONUS_PICK_REVEAL')">üéÅ</div>
                            <div class="pick-item" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'BONUS_PICK_REVEAL')">üéÅ</div>
                            <div class="pick-item" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'BONUS_PICK_END')">‚ùå</div>
                        </div>
                    </div>

                    <!-- JACKPOT -->
                    <div class="feature-screen" id="screen-jackpot">
                        <h3 style="text-align: center; margin-bottom: 20px; color: #f6ad55;">üéä JACKPOT! üéä</h3>
                        <div class="jackpot-display">
                            <div class="jackpot-tier mini" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'JACKPOT_MINI')">
                                <div class="jp-label">Mini</div>
                                <div class="jp-value">$100</div>
                            </div>
                            <div class="jackpot-tier minor" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'JACKPOT_MINOR')">
                                <div class="jp-label">Minor</div>
                                <div class="jp-value">$500</div>
                            </div>
                            <div class="jackpot-tier major" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'JACKPOT_MAJOR')">
                                <div class="jp-label">Major</div>
                                <div class="jp-value">$2,500</div>
                            </div>
                            <div class="jackpot-tier grand" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'JACKPOT_GRAND')">
                                <div class="jp-label">Grand</div>
                                <div class="jp-value">$50,000</div>
                            </div>
                        </div>
                        <div class="slot-controls">
                            <button class="spin-btn primary" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'JACKPOT_COLLECT')">COLLECT</button>
                        </div>
                    </div>

                    <!-- Transition Zones (always visible) -->
                    <div class="transition-zones">
                        <span style="color: #666; font-size: 11px; margin-right: 10px;">TRANSITIONS:</span>
                        <div class="transition-zone" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'TRANS_BASE_TO_FS')">Base ‚Üí FS</div>
                        <div class="transition-zone" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'TRANS_FS_TO_BASE')">FS ‚Üí Base</div>
                        <div class="transition-zone" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'TRANS_BASE_TO_HW')">Base ‚Üí H&W</div>
                        <div class="transition-zone" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'TRANS_HW_TO_BASE')">H&W ‚Üí Base</div>
                        <div class="transition-zone has-audio" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'TRANS_BASE_TO_BONUS')">Base ‚Üí Bonus</div>
                        <div class="transition-zone" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'TRANS_BONUS_TO_BASE')">Bonus ‚Üí Base</div>
                        <div class="transition-zone" ondragover="allowDrop(event)" ondrop="dropAudio(event, 'TRANS_ANY_TO_JP')">Any ‚Üí Jackpot</div>
                    </div>
                </div>

                <!-- Timeline -->
                <div class="timeline">
                    <div class="timeline-header">
                        <span class="timeline-title">Timeline Events</span>
                        <span style="color: #666; font-size: 12px;" id="stateLabel">Base Game</span>
                    </div>
                    <div class="timeline-events" id="timelineEvents">
                        <div class="timeline-event event-spin">
                            <div class="event-name">SPIN_START</div>
                            <div class="event-audio">spin_whoosh.wav</div>
                        </div>
                        <div class="timeline-event event-symbol">
                            <div class="event-name">REEL_STOP_0</div>
                            <div class="event-audio">reel_stop_1.wav</div>
                        </div>
                        <div class="timeline-event event-symbol">
                            <div class="event-name">SCATTER_LAND_3</div>
                            <div class="event-audio">scatter_anticipation.wav</div>
                        </div>
                        <div class="timeline-event event-win">
                            <div class="event-name">WIN_PRESENT</div>
                            <div class="event-audio">win_medium.wav</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Audio Browser (shown in EDIT mode) -->
    <div class="audio-browser" id="audioBrowser">
        <div class="browser-title">üéµ Audio Files</div>
        <div class="audio-item" draggable="true" ondragstart="dragAudio(event, 'spin_whoosh.wav')">
            <span class="audio-icon">üîä</span>
            <span class="audio-name">spin_whoosh.wav</span>
        </div>
        <div class="audio-item" draggable="true" ondragstart="dragAudio(event, 'reel_stop.wav')">
            <span class="audio-icon">üîä</span>
            <span class="audio-name">reel_stop.wav</span>
        </div>
        <div class="audio-item" draggable="true" ondragstart="dragAudio(event, 'wild_land.wav')">
            <span class="audio-icon">üîä</span>
            <span class="audio-name">wild_land.wav</span>
        </div>
        <div class="audio-item" draggable="true" ondragstart="dragAudio(event, 'scatter_land.wav')">
            <span class="audio-icon">üîä</span>
            <span class="audio-name">scatter_land.wav</span>
        </div>
        <div class="audio-item" draggable="true" ondragstart="dragAudio(event, 'win_small.wav')">
            <span class="audio-icon">üîä</span>
            <span class="audio-name">win_small.wav</span>
        </div>
        <div class="audio-item" draggable="true" ondragstart="dragAudio(event, 'win_big.wav')">
            <span class="audio-icon">üîä</span>
            <span class="audio-name">win_big.wav</span>
        </div>
        <div class="audio-item" draggable="true" ondragstart="dragAudio(event, 'feature_trigger.wav')">
            <span class="audio-icon">üîä</span>
            <span class="audio-name">feature_trigger.wav</span>
        </div>
        <div class="audio-item" draggable="true" ondragstart="dragAudio(event, 'jackpot_win.wav')">
            <span class="audio-icon">üîä</span>
            <span class="audio-name">jackpot_win.wav</span>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast"></div>

    <!-- Instructions -->
    <div class="instructions">
        <strong>PLAY mode:</strong> Click SPIN to play<br>
        <strong>EDIT mode:</strong> Drag audio to drop targets
    </div>

    <script>
        let currentMode = 'play';
        let currentState = 'base';
        let isSpinning = false;

        function setMode(mode) {
            currentMode = mode;
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.mode-btn.${mode}`).classList.add('active');

            // Show/hide audio browser
            document.getElementById('audioBrowser').classList.toggle('visible', mode === 'edit');

            // Show/hide symbol strip drop targets
            document.getElementById('symbolStrip').style.opacity = mode === 'edit' ? '1' : '0.6';

            // Toggle drop target styling
            document.querySelectorAll('.reel, .spin-btn, .control-btn, .pick-item, .jackpot-tier, .fs-stat, .hw-cell').forEach(el => {
                el.classList.toggle('drop-target', mode === 'edit');
            });
        }

        function setState(state) {
            currentState = state;
            document.querySelectorAll('.state-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');

            // Hide all screens, show selected
            document.querySelectorAll('.feature-screen').forEach(screen => screen.classList.remove('active'));
            document.getElementById(`screen-${state}`).classList.add('active');

            // Update timeline label
            const labels = {
                base: 'Base Game',
                freespins: 'Free Spins',
                holdwin: 'Hold & Win',
                bonus: 'Bonus Game',
                jackpot: 'Jackpot'
            };
            document.getElementById('stateLabel').textContent = labels[state];

            // Update timeline events based on state
            updateTimelineForState(state);
        }

        function updateTimelineForState(state) {
            const events = {
                base: [
                    { name: 'SPIN_START', audio: 'spin_whoosh.wav', type: 'spin' },
                    { name: 'REEL_STOP_0', audio: 'reel_stop_1.wav', type: 'symbol' },
                    { name: 'WIN_PRESENT', audio: 'win_medium.wav', type: 'win' }
                ],
                freespins: [
                    { name: 'FS_SPIN_START', audio: 'fs_spin.wav', type: 'spin' },
                    { name: 'FS_MULTIPLIER_UP', audio: 'multiplier_up.wav', type: 'feature' },
                    { name: 'FS_TOTAL_WIN', audio: 'fs_total.wav', type: 'win' }
                ],
                holdwin: [
                    { name: 'HW_RESPIN', audio: 'hw_respin.wav', type: 'spin' },
                    { name: 'HW_SYMBOL_LOCK', audio: 'lock_symbol.wav', type: 'feature' },
                    { name: 'HW_GRID_FULL', audio: 'grid_complete.wav', type: 'win' }
                ],
                bonus: [
                    { name: 'BONUS_PICK_REVEAL', audio: 'pick_reveal.wav', type: 'feature' },
                    { name: 'BONUS_PRIZE_WIN', audio: 'bonus_prize.wav', type: 'win' }
                ],
                jackpot: [
                    { name: 'JACKPOT_TRIGGER', audio: 'jp_trigger.wav', type: 'feature' },
                    { name: 'JACKPOT_GRAND', audio: 'grand_fanfare.wav', type: 'win' },
                    { name: 'JACKPOT_COLLECT', audio: 'collect.wav', type: 'win' }
                ]
            };

            const container = document.getElementById('timelineEvents');
            container.innerHTML = events[state].map(e => `
                <div class="timeline-event event-${e.type}">
                    <div class="event-name">${e.name}</div>
                    <div class="event-audio">${e.audio}</div>
                </div>
            `).join('');
        }

        function toggleSymbol(item) {
            if (event.target.closest('.context-item') || event.target.closest('.toggle-switch') || event.target.closest('.quantity-item')) {
                return;
            }
            item.classList.toggle('expanded');
        }

        function togglePerReel(toggle) {
            toggle.classList.toggle('active');
        }

        function spin() {
            if (currentMode === 'edit' || isSpinning) return;

            isSpinning = true;
            document.getElementById('spinBtn').textContent = 'SPINNING...';

            // Start spinning animation
            document.querySelectorAll('.reel').forEach(reel => reel.classList.add('spinning'));

            // Stop reels sequentially
            const delays = [800, 1000, 1200, 1400, 1600];
            document.querySelectorAll('.reel').forEach((reel, i) => {
                setTimeout(() => {
                    reel.classList.remove('spinning');
                    // Randomize final position
                    const strip = reel.querySelector('.reel-strip');
                    const offset = Math.floor(Math.random() * 3) * -80;
                    strip.style.transform = `translateY(${offset}px)`;
                }, delays[i]);
            });

            // Complete spin
            setTimeout(() => {
                isSpinning = false;
                document.getElementById('spinBtn').textContent = 'SPIN';

                // Random win
                if (Math.random() > 0.5) {
                    const win = (Math.random() * 100).toFixed(2);
                    document.getElementById('winAmount').textContent = `$${win}`;
                } else {
                    document.getElementById('winAmount').textContent = '$0.00';
                }
            }, 1800);
        }

        // Drag and drop
        function dragAudio(event, filename) {
            event.dataTransfer.setData('audio', filename);
        }

        function allowDrop(event) {
            if (currentMode === 'edit') {
                event.preventDefault();
                event.currentTarget.classList.add('drag-over');
            }
        }

        function dropAudio(event, targetId) {
            event.preventDefault();
            event.currentTarget.classList.remove('drag-over');

            if (currentMode !== 'edit') return;

            const audio = event.dataTransfer.getData('audio');
            if (audio) {
                showToast(`‚úì Assigned "${audio}" ‚Üí ${targetId}`);

                // Mark as having audio
                if (event.currentTarget.classList.contains('context-item')) {
                    event.currentTarget.classList.add('has-audio');
                    const status = event.currentTarget.querySelector('.context-status');
                    if (status) {
                        status.classList.remove('empty');
                        status.classList.add('filled');
                        status.textContent = '‚úì';
                    }
                }

                // Add to timeline
                addTimelineEvent(targetId, audio);
            }
        }

        function addTimelineEvent(stage, audio) {
            const container = document.getElementById('timelineEvents');
            const type = stage.includes('WIN') ? 'win' :
                         stage.includes('SPIN') ? 'spin' :
                         stage.includes('SYMBOL') || stage.includes('REEL') || stage.includes('WILD') || stage.includes('SCATTER') ? 'symbol' : 'feature';

            const eventEl = document.createElement('div');
            eventEl.className = `timeline-event event-${type}`;
            eventEl.innerHTML = `
                <div class="event-name">${stage}</div>
                <div class="event-audio">${audio}</div>
            `;
            container.appendChild(eventEl);
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2000);
        }

        function addSymbol() {
            showToast('Symbol Registry ‚Üí Define new symbol');
        }

        // Remove drag-over on drag leave
        document.addEventListener('dragleave', (e) => {
            if (e.target.classList) {
                e.target.classList.remove('drag-over');
            }
        });
    </script>
</body>
</html>
